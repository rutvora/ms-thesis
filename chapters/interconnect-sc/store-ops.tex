\section{Generating contention via CPU instructions}
\label{sec:interconnect-sc-store-ops}

There are two primary ways one can generate traffic on the PCIe link.
1) CPU \textit{load} or \textit{store} instructions on memory-mapped PCIe configuration, device memory, or I/O address space, and 
2) direct memory access (DMA) to copy data between the PCIe device memory and the DRAM.
In this section, we discuss how to use CPU instructions to generate the traffic and defer the discussion of generating traffic via DMA to \Cref{sec:interconnect-sc-dma}.
In this section, we also answer \textbf{RQ1}, ``Is it possible to create contention in PCIe links without the adversary saturating the PCIe bandwidth?''.

An adversary can generate traffic from the CPU by mapping a PCIe device resource to an application running on the CPU and issuing load or store operations on the mapped memory.
Each load/store operation will be buffered in the PCIe controller until a transaction layer packet (TLP) is generated and ready to be transmitted.
Two factors influence the actual transmission time of the packet:
1) The ordering of the packets, as outlined in \Cref{tab:pcie-transaction-ordering-rules}, and
2) The number of pending packets in the PCIe controller buffer that are not subject to any ordering rules relative to the current packet.
If the packets do not have any relative ordering rule, it is reasonable to assume that the controller follows a first come, first serve policy.
As such, any packet generated by the adversary can either be delayed due to existing traffic in the buffer or not, as there is no traffic in the buffer.
This allows the attacker to observe the presence or absence of victim traffic without necessarily saturating the PCIe bandwidth.

To observe the victim traffic, the attacker should ensure they have a packet pending in the PCIe controller as frequently as possible.
This ensures that the attacker can observe the presence or absence of victim traffic at a fine granularity.
The attacker also needs to ensure that the packet would not be delayed because of their traffic.
To achieve these goals, the attacker must determine the correct combination of the PCIe resource and instruction, as different instructions on different resources can lead to different PCIe transactions and transaction ordering rules.


\input{chapters/interconnect-sc/store-ops/challenges}
\input{chapters/interconnect-sc/store-ops/measuring-store-time}
% \input{chapters/interconnect-sc/store-ops/evaluation}
 